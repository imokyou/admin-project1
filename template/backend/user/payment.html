{% extends "backend/base.html" %}

{% block title %}会员充值记录{% endblock %}
{% block body %}
<div class="wrapper">
    <div class="container">

        <!-- Page-Title -->
        <div class="row">
            <div class="col-sm-12">
                <h4 class="page-title">会员充值记录</h4>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-12">
                <div class="card-box table-responsive">
                    <div class="pull-right">
                    {% if paging.has_previous %}
                        <a href="{{paging.prev_url}}">
                            上一页
                        </a>
                    {% endif %}
                        第{{ paging.p }}/{{ paging.pages }}页,共{{ paging.tot }}条记录
                    {% if paging.has_next %}
                        <a href="{{paging.next_url}}">
                            下一页
                        </a>
                    {% endif %}
                    </div>
                    <div>
                        <form class="form-inline">
                            <div class="form-group m-r-10">
                                <label for="username">账号: </label>
                                {{ forms.username }}
                            </div>
                            <div class="form-group m-r-10">
                                <label for="pay_type">类型: </label>
                                {{ forms.pay_type }}
                            </div>
                            <div class="form-group m-r-10">
                                <label for="pay_type">状态: </label>
                                {{ forms.status }}
                            </div>
                            <button type="submit" class="btn btn-default waves-effect waves-light btn-md">
                                点击查询
                            </button>
                        </form>
                    </div>
                    <table id="datatable" class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>账号</th>
                                <th>充值类型</th>
                                <th>资本兑</th>
                                <th>金额</th>
                                <th>时间</th>
                                <th>IP</th>
                                <th>状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>

                        <tbody>
                        {% for payment in payment_list.data %}
                            <tr>
                                <td>{{ payment.id }}</td>
                                <td>{{ payment.username }}</td>
                                <td>{{ payment.pay_type }}</td>
                                <td>{{ payment.point }}</td>
                                <td>{{ payment.payout }}</td>
                                <td>{{ payment.create_time }}</td>
                                <td>{{ payment.ip }}</td>
                                <td>{{ payment.status_name }}</td>
                                <td>
                                    {% if payment.status != 1 %}
                                    <a href="javascript:paySuccess('{{ payment.order_id }}');"  class="btn btn-sm btn-danger waves-effect waves-light btn-sm">
                                        确认充值成功
                                    </a>
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <div class="pull-right">
                    {% if paging.has_previous %}
                        <a href="{{paging.prev_url}}">
                            上一页
                        </a>
                    {% endif %}
                        第{{ paging.p }}/{{ paging.pages }}页,共{{ paging.tot }}条记录
                    {% if paging.has_next %}
                        <a href="{{paging.next_url}}">
                            下一页
                        </a>
                    {% endif %}
                    </div>
                </div>
            </div><!-- end col -->
        </div>
        <!-- end row -->
        <!-- Footer -->
        <footer class="footer text-right">
            <div class="container">
                <div class="row">
                    <div class="col-xs-6">
                        2016 © Adminto.
                    </div>
                    <div class="col-xs-6">
                        <ul class="pull-right list-inline m-b-0">
                            <li>
                                <a href="#">About</a>
                            </li>
                            <li>
                                <a href="#">Help</a>
                            </li>
                            <li>
                                <a href="#">Contact</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>
        <!-- End Footer -->

    </div>
    <!-- end container -->



    <!-- Right Sidebar -->
    <div class="side-bar right-bar">
        <a href="javascript:void(0);" class="right-bar-toggle">
            <i class="zmdi zmdi-close-circle-o"></i>
        </a>
        <h4 class="">Notifications</h4>
        <div class="notification-list nicescroll">
            <ul class="list-group list-no-border user-list">
                <li class="list-group-item">
                    <a href="#" class="user-list-item">
                        <div class="avatar">
                            <img src="/static/images/users/avatar-2.jpg" alt="">
                        </div>
                        <div class="user-desc">
                            <span class="name">Michael Zenaty</span>
                            <span class="desc">There are new settings available</span>
                            <span class="time">2 hours ago</span>
                        </div>
                    </a>
                </li>
                <li class="list-group-item">
                    <a href="#" class="user-list-item">
                        <div class="icon bg-info">
                            <i class="zmdi zmdi-account"></i>
                        </div>
                        <div class="user-desc">
                            <span class="name">New Signup</span>
                            <span class="desc">There are new settings available</span>
                            <span class="time">5 hours ago</span>
                        </div>
                    </a>
                </li>
                <li class="list-group-item">
                    <a href="#" class="user-list-item">
                        <div class="icon bg-pink">
                            <i class="zmdi zmdi-comment"></i>
                        </div>
                        <div class="user-desc">
                            <span class="name">New Message received</span>
                            <span class="desc">There are new settings available</span>
                            <span class="time">1 day ago</span>
                        </div>
                    </a>
                </li>
                <li class="list-group-item active">
                    <a href="#" class="user-list-item">
                        <div class="avatar">
                            <img src="/static/images/users/avatar-3.jpg" alt="">
                        </div>
                        <div class="user-desc">
                            <span class="name">James Anderson</span>
                            <span class="desc">There are new settings available</span>
                            <span class="time">2 days ago</span>
                        </div>
                    </a>
                </li>
                <li class="list-group-item active">
                    <a href="#" class="user-list-item">
                        <div class="icon bg-warning">
                            <i class="zmdi zmdi-settings"></i>
                        </div>
                        <div class="user-desc">
                            <span class="name">Settings</span>
                            <span class="desc">There are new settings available</span>
                            <span class="time">1 day ago</span>
                        </div>
                    </a>
                </li>

            </ul>
        </div>
    </div>
    <!-- /Right-bar -->

</div>
{% endblock %}

{% block script %}
<script type="text/javascript">
function paySuccess(order_id) {
    var flag = confirm('确认充值成功？')
    if (flag) {
        $.ajax({
            url: '/backend/user/payment-success/',
            type: 'POST',
            dataType: 'json',
            data: { order_id: order_id, status: 1},
            async: false,
            success: function(resp) {
                if (resp.c != 0) {
                    alert(resp.m);
                }
                location.reload();
            }
        });
    }
}
</script>
{% endblock %}